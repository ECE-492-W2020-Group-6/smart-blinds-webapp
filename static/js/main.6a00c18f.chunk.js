(this["webpackJsonpsmart-blinds-webapp"]=this["webpackJsonpsmart-blinds-webapp"]||[]).push([[0],{100:function(e,t,a){},111:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(8),c=a.n(o),l=a(18),i=(a(100),a(9)),s=a(19),u=a.n(s),d=a(37),m=a(30),p=a(25),f=function(){function e(t){Object(m.a)(this,e),this.credentials=void 0,this.credentials=t}return Object(p.a)(e,[{key:"createFetch",value:function(){var e=Object(d.a)(u.a.mark((function e(t,a,n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={},e.t0=a,e.next="GET"===e.t0?4:"POST"===e.t0?6:8;break;case 4:return r={method:a,mode:"cors",headers:{"Content-Type":"text/json",Auth:this.credentials.password}},e.abrupt("break",8);case 6:return r={method:a,mode:"cors",headers:{"Content-Type":"application/json",Auth:this.credentials.password},body:n},e.abrupt("break",8);case 8:return console.log(this.credentials.address+t,r),e.abrupt("return",fetch(this.credentials.address+t,r));case 10:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()}]),e}(),b=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],h=function(){function e(t,a){Object(m.a)(this,e),this.name=void 0,this.BlindAPI=void 0,this.address=void 0,this.BlindAPI=new f(a),this.name=t,this.address=a.address}return Object(p.a)(e,[{key:"getStatus",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.BlindAPI.createFetch("/temp","GET");case 2:return t=e.sent,e.next=5,t.clone().json();case 5:return a=e.sent,n={indoorTemp:a.temperature,outdoorTemp:-23,cloudCoverage:"High",motorPosition:50},e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"GetCurrentBehavior",value:function(e){var t=this,a=new Date,n=e[b[a.getUTCDay()]];return 0===n.length?e.defaultMode:(n.forEach((function(e){if(t.TimeslotIsActive(e,a))return e.mode})),e.defaultMode)}},{key:"TimeslotIsActive",value:function(e,t){function a(e){return"".concat(e.getUTCHours).concat(e.getUTCMinutes).concat(e.getUTCSeconds)}var n=a(t);return n>=a(e.start)&&n<a(e.end)}},{key:"getSchedule",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=j.testCases.schedules[0],a=new Promise((function(e,a){setTimeout((function(){e(t)}),500)})),e.abrupt("return",a);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setSchedule",value:function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.BlindAPI.createFetch("/schedule","POST",JSON.stringify(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendCommand",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.BlindAPI.createFetch("/command","POST",JSON.stringify(t));case 2:return a=e.sent,e.next=5,a.clone().json();case 5:n=e.sent,console.log(n);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getName",value:function(){return this.name}},{key:"setName",value:function(e){this.name=e}},{key:"getAddress",value:function(){return this.address}}]),e}(),E={type:"ECO"},g=new Date("2020-03-22T06:00:00Z"),v=new Date(g);v.setHours(4),new Date(v).setHours(8);var y={defaultMode:E,monday:[],tuesday:[],wednesday:[],thursday:[],friday:[],saturday:[],sunday:[]},O=new h("Physical Test",{address:"http://10.147.17.181:5000/api/v1",password:""}),j={root:"/smart-blinds-webapp",defaultPath:"/",mainTitle:"Smart Blinds",MOTORMIDPOINT:50,testCases:{schedules:[y],stats:[{indoorTemp:21,outdoorTemp:20,cloudCoverage:"Low",motorPosition:0}],blinds:[new h("Local Test",{address:"http://127.0.0.1:5000/api/v1",password:""}),O,new h("Test Blinds",{address:"localhost",password:"123pass"}),new h("Other blinds",{address:"1.255.02.3",password:"pass123"})]},defaultObjects:{schedule:y,blindMode:E,stats:{indoorTemp:0,outdoorTemp:0,cloudCoverage:"Low",motorPosition:0}}},w=a(23),C=a(90),T=a(74),S=a.n(T),x=a(73),k=a.n(x),N=a(72),M=a.n(N),P=Object(C.a)({palette:{primary:M.a,secondary:k.a,info:S.a}}),A=a(156),B=a(155),I=a(139),G=a(142),R=a(143),D=a(52),L=a(5),F=a(77),H=a.n(F),W=Object(L.a)((function(e){return Object(B.a)({root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}})}))((function(e){var t=e.classes,a=e.title;return r.a.createElement(r.a.Fragment,null,r.a.createElement(I.a,{position:"static"},r.a.createElement(G.a,null,r.a.createElement(R.a,{component:l.b,to:j.root+"/",edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu"},r.a.createElement(H.a,null)),r.a.createElement(D.a,{variant:"h6",color:"inherit"},a))))})),U=a(151),J=a(147),K=a(144),Z=a(112),$=a(114),q=a(145),z=a(146),Q=a(81),V=a.n(Q),X=a(50),Y=a.n(X),_=a(78),ee=a.n(_),te=a(79),ae=a.n(te),ne=a(80),re=a.n(ne),oe=Object(L.a)((function(e){return Object(B.a)({root:{flexGrow:1,padding:e.spacing(0)},title:{flexGrow:1,padding:e.spacing(2)}})}))((function(e){var t=e.classes,a=e.stats;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Z.a,{className:t.root},r.a.createElement(D.a,{className:t.title,color:"textPrimary"},"Current Status:"),r.a.createElement(K.a,{className:t.root}),r.a.createElement($.a,null,r.a.createElement(q.a,null,r.a.createElement(Y.a,null)),r.a.createElement(z.a,{secondary:"Indoor Temperature",primary:"".concat(a.indoorTemp,"\xb0")})),r.a.createElement($.a,null,r.a.createElement(q.a,null,a.outdoorTemp<5?r.a.createElement(ee.a,null):r.a.createElement(ae.a,null)),r.a.createElement(z.a,{secondary:"Outdoor Temperature",primary:"".concat(a.outdoorTemp,"\xb0")})),r.a.createElement($.a,null,r.a.createElement(q.a,null,r.a.createElement(re.a,null)),r.a.createElement(z.a,{secondary:"Cloud Coverage",primary:a.cloudCoverage}))))})),ce=Object(L.a)((function(e){return Object(B.a)({root:{flexGrow:1,padding:e.spacing(0)},title:{flexGrow:1,padding:e.spacing(2)},list:{padding:e.spacing(0)}})}))((function(e){var t=e.blindList,a=e.switchBlind,o=e.classes,c=j.defaultObjects.stats,s=Object(n.useState)(c),u=Object(i.a)(s,2),d=u[0],m=u[1];return Object(n.useEffect)((function(){t[0].getStatus().then((function(e){m(e)}));var e=setInterval((function(){t[0].getStatus().then((function(e){console.log("updated"),m(e)}))}),5e3);return function(){return clearInterval(e)}})),r.a.createElement("div",{className:o.root},r.a.createElement(oe,{stats:d}),r.a.createElement(J.a,null),r.a.createElement(K.a,{className:o.list},t.map((function(e){return r.a.createElement(r.a.Fragment,{key:e.getAddress()},r.a.createElement(Z.a,null,r.a.createElement($.a,{button:!0,onClick:function(){a(e)},component:l.b,to:j.root+"/blind"},r.a.createElement(q.a,null,r.a.createElement(V.a,null)),r.a.createElement(z.a,{primary:e.getName()}))),r.a.createElement(J.a,null))}))))})),le=a(148),ie=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(le.a,{variant:"contained",color:"primary"},"Hello World"))},se=a(85),ue=a.n(se),de=a(86),me=a.n(de),pe=a(58),fe=a.n(pe),be=a(84),he=a.n(be),Ee=a(82),ge=a.n(Ee),ve=a(83),ye=a.n(ve),Oe=Object(L.a)((function(e){return Object(B.a)({root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},appBar:{top:"auto",bottom:0},toolBar:{display:"flex",justifyContent:"space-between"}})}))((function(e){var t=e.buttons,a=e.classes;return r.a.createElement(r.a.Fragment,null,r.a.createElement(I.a,{position:"fixed",className:a.appBar},r.a.createElement(G.a,{className:a.toolBar},t.map((function(e,t){return r.a.createElement(r.a.Fragment,{key:t},e)})))))})),je=a(154),we=a(149),Ce=a(157),Te=a(152),Se=a(150);function xe(){return{top:"".concat(50,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(50,"%)")}}var ke=Object(L.a)((function(e){return Object(B.a)({root:{flexGrow:1,padding:e.spacing(0)},modalDiv:{position:"absolute",width:"90%",backgroundColor:e.palette.background.paper,border:"2px solid",borderRadius:"4px",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},formControl:{margin:e.spacing(1),midWidth:120},inputs:{display:"flex",justifyContent:"left"}})}))((function(e){var t=e.classes,a=e.open,o=e.handleClose,c=e.sendCommand,l=Object(n.useState)(xe),s=Object(i.a)(l,1)[0],u=Object(n.useState)(30),d=Object(i.a)(u,2),m=d[0],p=d[1],f=Object(n.useState)(0),b=Object(i.a)(f,2);b[0],b[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(je.a,{open:a,onClose:o},r.a.createElement("div",{style:s,className:t.modalDiv,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},r.a.createElement("h2",{id:"simple-modal-title"},"Manual Control"),r.a.createElement("p",{id:"simple-modal-description"},"Control the blinds directly"),r.a.createElement("div",{className:t.inputs},r.a.createElement(we.a,{className:t.formControl},r.a.createElement(Ce.a,null,"Duration"),r.a.createElement(Te.a,{value:m,onChange:function(e){p(e.target.value)}},r.a.createElement(Se.a,{value:30},"30 Mins"),r.a.createElement(Se.a,{value:60},"1 Hour"),r.a.createElement(Se.a,{value:240},"4 Hours"),r.a.createElement(Se.a,{value:0},"Today"))),r.a.createElement(le.a,{onClick:function(){c("LIGHT",m),o()}},"Open"),r.a.createElement(le.a,{onClick:function(){c("DARK",m),o()}},"Close")))))})),Ne=Object(L.a)((function(e){return Object(B.a)({root:{flexGrow:1,padding:e.spacing(0)},title:{flexGrow:1,padding:e.spacing(2)},list:{padding:e.spacing(0)}})}))((function(e){var t=e.classes,a=e.blind,o=Object(n.useState)(),c=Object(i.a)(o,2),s=c[0],u=c[1],d=Object(n.useState)(),m=Object(i.a)(d,2),p=m[0],f=m[1],b=Object(n.useState)(j.defaultObjects.blindMode),h=Object(i.a)(b,2),E=h[0],g=h[1],v=Object(n.useState)(!1),y=Object(i.a)(v,2),O=y[0],w=y[1];Object(n.useEffect)((function(){void 0!==a&&(a.getSchedule().then((function(e){f(e),g(a.GetCurrentBehavior(e))})),a.getStatus().then((function(e){u(e)})))}),[a]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Z.a,{className:t.root},r.a.createElement(D.a,{className:t.title,color:"textPrimary"},"Current Status:"),r.a.createElement(K.a,{className:t.root}),r.a.createElement($.a,null,r.a.createElement(q.a,null,r.a.createElement(Y.a,null)),r.a.createElement(z.a,{secondary:"Indoor Temperature",primary:void 0===s?"loading...":"".concat(s.indoorTemp,"\xb0")})),r.a.createElement($.a,null,r.a.createElement(q.a,null,void 0===s?r.a.createElement(fe.a,null):s.motorPosition>j.MOTORMIDPOINT?r.a.createElement(ge.a,null):r.a.createElement(ye.a,null)),r.a.createElement(z.a,{secondary:"Motor Position",primary:void 0===s?"loading...":s.motorPosition})),r.a.createElement($.a,null,r.a.createElement(q.a,null,void 0===p?r.a.createElement(fe.a,null):"ECO"===E.type?r.a.createElement(he.a,null):"LIGHT"===E.type?r.a.createElement(ue.a,null):r.a.createElement(me.a,null)),r.a.createElement(z.a,{secondary:"Behavior",primary:void 0===p?"loading...":E.type}))),r.a.createElement(Oe,{buttons:[r.a.createElement(le.a,{onClick:function(){w(!0)},color:"inherit"},"Manual Control"),r.a.createElement(le.a,{component:l.b,to:j.root+"/blind/createschedule",color:"inherit"},"Set Schedule")]}),r.a.createElement(ke,{open:O,handleClose:function(){w(!1)},sendCommand:function(e,t,n){var r=0;void 0!==n&&(r=n),a.sendCommand({mode:e,duration:t,position:r})}}))})),Me=a(22),Pe=a(87),Ae=a(88),Be=a(91),Ie=a(89),Ge=a.n(Ie),Re=(a(110),function(e){function t(){return Object(m.a)(this,t),Object(Pe.a)(this,Object(Ae.a)(t).apply(this,arguments))}return Object(Be.a)(t,e),t}(Ge.a)),De=Object(L.a)((function(e){return Object(B.a)({root:{flexGrow:1,padding:e.spacing(0)},weekWrapper:{display:"grid",gridTemplateColumns:"repeat(8, minmax(25px, 1fr))",gridTemplateRows:"1fr",gridAutoFlow:"dense",justifyItems:"stretch",alignItems:"stretch",margin:e.spacing(1)},timeSlotWrapper:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"scroll",height:"70vh"},dayHeader:{textAlign:"center"},tableRow:{height:e.spacing(6),textAlign:"center",alignItems:"center",padding:"0px"},timeTable:{borderBottomColor:"rgb(139, 195, 74)",tableLayout:"fixed",borderSpacing:"0px",width:"calc(100% - 8px)",minWidth:e.spacing(3),margin:e.spacing(1)},fitTables:{width:"12.5%"},ecoClass:{verticalAlign:"middle !important",background:"".concat(e.palette.primary.light," !important"),color:"".concat(e.palette.grey[800]," !important")},lightClass:{verticalAlign:"middle !important",background:"".concat(e.palette.info.light," !important"),color:"".concat(e.palette.grey[800]," !important")},darkClass:{verticalAlign:"middle !important",background:"".concat(e.palette.grey[600]," !important"),color:"".concat(e.palette.grey[50]," !important")},customClass:{verticalAlign:"middle !important",background:"".concat(e.palette.secondary.light," !important"),color:"".concat(e.palette.grey[800]," !important")},typeSelect:{display:"flex",justifyContent:"space-around"}})}))((function(e){var t=e.classes,a=e.blind,o=Object(n.useState)(j.defaultObjects.schedule),c=Object(i.a)(o,2),s=c[0],u=c[1],d=function(e){var t=0;return t+=4*e.getHours(),t+=15*Math.ceil(e.getMinutes()/15)},m={ECO:t.ecoClass,LIGHT:t.lightClass,DARK:t.darkClass,CUSTOM:t.customClass},p=function(e){for(var t=[],a=function(a){for(var n=b[a],r=0;r<96;r++)void 0===t[r]&&(t[r]=[]),t[r].push({value:e.defaultMode.type.toLowerCase(),mode:e.defaultMode,className:m[e.defaultMode.type],readOnly:!0});e[n].forEach((function(e){for(var n=d(e.start),r=d(e.end),o=n;o<r;o++)t[o][a].value=e.mode.type.toLowerCase(),t[o][a].mode=e.mode,t[o][a].className=m[e.mode.type]}))},n=0;n<7;n++)a(n);return t},f=Object(n.useState)(p(s)),h=Object(i.a)(f,2),E=h[0],g=h[1],v=Object(n.useState)(j.defaultObjects.blindMode),y=Object(i.a)(v,2),O=y[0],w=y[1],C=Object(n.useState)(O.percentage?O.percentage:0),T=Object(i.a)(C,2),S=T[0],x=(T[1],Object(n.useState)()),k=Object(i.a)(x,2),N=k[0],M=k[1];Object(n.useEffect)((function(){void 0!==a&&a.getSchedule().then((function(e){u(e)}))}),[a]),Object(n.useEffect)((function(){void 0!==s&&g(p(s))}),[s]);for(var P=function(){var e=function(e){var t=j.defaultObjects.schedule;t.defaultMode=O;var a=function(e){return r(Math.floor(e/4))},n=function(e){return r(e%24*15)},r=function(e){for(var t=String(e);t.length<2;)t="0"+t;return t};return e.forEach((function(e){for(var r=0;r<e.length;r++){var o=e[r];t[b[r]].push({start:new Date("2020-03-22T".concat(a(r),":").concat(n(r),":00Z")),end:new Date("2020-03-22T".concat(a(r+1),":").concat(n(r+1),":00Z")),mode:o.mode})}})),t}(E);u(e),a.setSchedule(e)},A=["Time"].concat(Object(Me.a)(b.map((function(e){return function(e){return e[0].toLocaleUpperCase()+e.slice(1,3)}(e)})))).map((function(e,a){return r.a.createElement(D.a,{key:e,className:t.dayHeader},e)})),B=[],I=0;I<96;I++){var G=Math.floor(I/4),R=G>11?"PM":"AM";"PM"===R&&12!==G?G-=12:0===G&&(G+=12);var L=I%4*15,F="".concat(G,":").concat(0===L?"00":L," ").concat(R," ");void 0===B[I]&&(B[I]=[]),B[I].push({value:F})}var H=r.a.createElement(Re,{data:E,valueRenderer:function(e){return e.value},className:t.timeTable,rowRenderer:function(e){return r.a.createElement("tr",{className:t.tableRow},e.children)},onSelect:function(e){M(e)}}),W=r.a.createElement(Re,{data:B,valueRenderer:function(e){return e.value},sheetRenderer:function(e){return r.a.createElement("table",{className:t.timeTable},r.a.createElement("tbody",null,e.children))},rowRenderer:function(e){return r.a.createElement("tr",{className:t.tableRow},e.children)}});return r.a.createElement(r.a.Fragment,null,r.a.createElement(Z.a,{className:t.root},r.a.createElement("div",{className:t.weekWrapper},A),r.a.createElement("div",{className:t.timeSlotWrapper},r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{className:t.fitTables},W),r.a.createElement("td",null,H))))),r.a.createElement("div",{className:t.typeSelect},r.a.createElement(D.a,null,"Timeslot mode"),r.a.createElement(we.a,null,r.a.createElement(Te.a,{value:O.type,onChange:function(e){w({type:e.target.value,percentage:S})}},r.a.createElement(Se.a,{value:"ECO"},"Eco"),r.a.createElement(Se.a,{value:"LIGHT"},"Light"),r.a.createElement(Se.a,{value:"DARK"},"Dark"),r.a.createElement(Se.a,{value:"CUSTOM"},"Custom"))),r.a.createElement(le.a,{onClick:function(){!function(){for(var e=E.map((function(e){return Object(Me.a)(e)})),t=N.start.i;t<=N.end.i;t++)for(var a=N.start.j;a<=N.end.j;a++)e[t][a].value=O.type.toLowerCase(),e[t][a].className=m[O.type];g(e)}()}},"Apply"))),r.a.createElement(Oe,{buttons:[r.a.createElement(le.a,{onClick:function(){P()},component:l.b,to:j.root+"/blind",color:"inherit"},"Save"),r.a.createElement(le.a,{component:l.b,to:j.root+"/blind",color:"inherit"},"Cancel")]}))})),Le=Object(L.a)((function(e){return Object(B.a)({root:{height:"100%",margin:"0",width:"100vw",position:"fixed"}})}))((function(e){var t=e.classes,a=j.testCases.blinds,o=Object(n.useState)(a),c=Object(i.a)(o,2),l=c[0],s=(c[1],Object(n.useState)(l[0])),u=Object(i.a)(s,2),d=u[0],m=u[1],p=Object(n.useState)("Smart Blinds"),f=Object(i.a)(p,2),b=f[0],h=f[1];function E(e){m(e),h(e.getName())}var g=Object(w.g)();return Object(n.useEffect)((function(){g.pathname===j.root+j.defaultPath&&h(j.mainTitle)}),[g]),r.a.createElement("div",{className:t.root},r.a.createElement(A.a,null),r.a.createElement(U.a,{theme:P},r.a.createElement(W,{title:b}),r.a.createElement(w.d,null,r.a.createElement(w.b,{exact:!0,path:j.root+"/",render:function(e){return r.a.createElement(ce,Object.assign({},e,{blindList:l,switchBlind:E}))}}),r.a.createElement(w.b,{exact:!0,path:j.root+"/blind",render:function(e){return r.a.createElement(Ne,Object.assign({},e,{blind:d}))}}),r.a.createElement(w.b,{path:j.root+"/schedules",component:ie}),r.a.createElement(w.b,{exact:!0,path:j.root+"/blind/createSchedule",render:function(e){return r.a.createElement(De,Object.assign({},e,{blind:d}))}}),r.a.createElement(w.a,{to:j.root+j.defaultPath}))))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(l.a,null,r.a.createElement(Le,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},95:function(e,t,a){e.exports=a(111)}},[[95,1,2]]]);
//# sourceMappingURL=main.6a00c18f.chunk.js.map